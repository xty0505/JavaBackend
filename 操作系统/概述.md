# 概述

## 基本特征

1. 并发

   程序宏观上在**一段时间内**同时运行，而并行指**同一时刻**多个程序能够同时运行。

   并行需要硬件支持，如多流水线、多核CPU或者分布式系统。

   操作系统通过引入进程，线程使得程序能够并发执行。

2. 共享

   系统中的资源可以被多个并发进程使用。

   两种共享方式：互斥共享、同时共享

3. 虚拟

   虚拟技术将一个**物理实体**转换为多个**逻辑实体**

   **时分复用技术**：多个进程在同一个CPU上并发执行，每个进程轮流占用CPU，每次执行一个小时间片并快速切换

   **空分复用技术**：虚拟内存将物理内存抽象为地址空间，每个进程都有自己的地址空间，地址空间的页被映射到物理内存中。当某个页不再物理内存中时，通过页面置换算法将该页置换到内存中。

4. 异步

   由于并发执行，进程不是一次性执行完毕，而是已不可预测的速度向前推进，每个进程执行多长时间是不能确定的。

##  基本功能

1. 进程管理

   进程控制、同步、通信、死锁处理、CPU调度等。

2. 内存管理

   内存分配、地址映射、内存保护和共享、虚拟内存等。

3. 文件管理

   文件创建、存储空间管理、目录管理、权限管理等。

4. 设备管理

   完成用户的I/O请求，方便用户使用各种设备，提高设备利用率。

   缓存管理、设备分配、处理、虚拟设备。

## 系统调用

用户无法直接操作硬件，操作系统为应用程序员提供了使用硬件功能的接口，这些接口称为**系统调用**。

用户进行系统调用后进程由用户态陷入内核态，操作系统对硬件进行操作结束后，进程重新恢复用户态。

### Linux下的系统调用

| Task     | Commands                    |
| -------- | --------------------------- |
| 进程控制 | fork(); exit(); wait();     |
| 进程通信 | pipe(); shmget(); mmap();   |
| 文件操作 | open(); read(); write();    |
| 设备操作 | ioctl(); read(); write();   |
| 信息维护 | getpid(); alarm(); sleep(); |
| 安全     | chmod(); umask(); chown();  |



## 宏内核和微内核

### 宏内核

将操作系统的功能作为一个紧密结合的整体放到内核，用户态和内核态映射到同一个地址空间。

- 各模块共享信息，进程执行速度和性能较高
- 内核中某一个模块崩溃整个内核也会崩溃，安全性较差
- 在内核中添加新功能需要各个模块做相应修改，可扩展性较差

### 微内核

操作系统供的功能被划分为小的、定义良好的模块，只有微内核一个模块运行在内核态，其他模块运行在用户态。用户态和内核态在不同的地址空间中实现。

- 多个进程执行需要频繁的在用户态和进程态之间切换，性能较低
- 某个用户态的进程崩溃不会影响内核，因此安全性较高
- 添加新的功能，只需要建立一个新的服务到用户空间去，内核空间无需修改，可扩展性较好

![image-20210202181058877](C:\Users\aasus\AppData\Roaming\Typora\typora-user-images\image-20210202181058877.png)



## 中断分类

### 外中断

由CPU执行指令以外的事件引起，如I/O完成中断，表示输入/输出设备处理已经完成，CPU能够发送下一个IO请求。

时钟中断、控制台中断

### 异常

由CPU执行指令的内部事件引起，如非法操作码、地址越界、算数溢出等

### 系统调用

用户程序中使用系统调用陷入内核态